var c=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});import x from"node:crypto";import A from"node:http";import*as H from"./e1b0bc.js";import*as M from"./3b1bd0.js";import*as _ from"./403ed2.js";var F=Object.create,v=Object.defineProperty,D=Object.getOwnPropertyDescriptor,B=Object.getOwnPropertyNames,W=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty,Y=(e=>typeof c<"u"?c:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof c<"u"?c:r)[t]}):e)(function(e){if(typeof c<"u")return c.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),f=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),G=(e,r)=>{for(var t in r)v(e,t,{get:r[t],enumerable:!0})},p=(e,r,t,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of B(r))!$.call(e,n)&&n!==t&&v(e,n,{get:()=>r[n],enumerable:!(s=D(r,n))||s.enumerable});return e},T=(e,r,t)=>(p(e,r,"default"),t&&p(t,r,"default")),w=(e,r,t)=>(t=e!=null?F(W(e)):{},p(r||!e||!e.__esModule?v(t,"default",{value:e,enumerable:!0}):t,e)),E=f(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.btoa=e.atob=void 0;function r(s){return Buffer.from(s,"base64").toString("binary")}e.atob=r;function t(s){return Buffer.from(s,"binary").toString("base64")}e.btoa=t}),j=f(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fetch=e.Response=e.Request=e.Headers=e.Blob=e.File=e.FormData=void 0;var r=_;Object.defineProperty(e,"Headers",{enumerable:!0,get:function(){return r.Headers}});var t=_;Object.defineProperty(e,"FormData",{enumerable:!0,get:function(){return t.FormData}});var s=M;Object.defineProperty(e,"File",{enumerable:!0,get:function(){return s.File}}),Object.defineProperty(e,"Blob",{enumerable:!0,get:function(){return s.Blob}});var n=class extends r.Request{constructor(l,d){super(l,d)}get headers(){return super.headers}clone(){return new n(this)}};e.Request=n;var o=class extends r.Response{get headers(){return super.headers}clone(){return super.clone()}};e.Response=o;var a=(l,d)=>(d={compress:!1,...d},(0,r.fetch)(l,d));e.fetch=a}),L=f(e=>{"use strict";var r=e&&e.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(e,"__esModule",{value:!0}),e.installGlobals=void 0;var t=r(x),s=H,n=E(),o=j();function a(){global.atob=n.atob,global.btoa=n.btoa,global.Blob=o.Blob,global.File=o.File,global.Headers=o.Headers,global.Request=o.Request,global.Response=o.Response,global.fetch=o.fetch,global.FormData=o.FormData,global.ReadableStream=s.ReadableStream,global.WritableStream=s.WritableStream,typeof global.crypto>"u"&&(global.crypto=t.default)}e.installGlobals=a}),k=f(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.writeReadableStreamToWritable=void 0;async function r(t,s){let n=t.getReader();async function o(){let{done:a,value:l}=await n.read();if(a){s.end();return}s.write(l),await o()}try{await o()}catch(a){throw s.destroy(a),a}}e.writeReadableStreamToWritable=r}),C=f(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRequestListener=void 0;var r=j(),t=k(),s=n=>async(o,a)=>{let l=o.method||"GET",d=`http://${o.headers.host}${o.url}`,y={},q=o.rawHeaders.length;for(let u=0;u<q;u++)if(u%2===0){let b=o.rawHeaders[u];y[b]=o.rawHeaders[u+1]}let m={method:l,headers:y};l==="GET"||l==="HEAD"||(m.body=new ReadableStream({start:async u=>{for await(let b of o)u.enqueue(b);u.close()}}));let i;try{i=await n(new Request(d.toString(),m))}catch{i=new r.Response(null,{status:500})}let g=i.headers.get("content-type")||"",h=i.headers.get("content-encoding");for(let[u,b]of i.headers)u==="set-cookie"?a.setHeader(u,i.headers.getAll(u)):a.setHeader(u,b);a.statusCode=i.status,i.body?!h&&g.startsWith("text")?a.end(await i.text()):!h&&g.startsWith("application/json")?a.end(await i.text()):await(0,t.writeReadableStreamToWritable)(i.body,a):a.end()};e.getRequestListener=s}),N=f(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.serve=e.createAdaptorServer=void 0;var r=A,t=L(),s=C();(0,t.installGlobals)();var n=a=>{let l=a.fetch,d=(0,s.getRequestListener)(l);return(0,r.createServer)(a.serverOptions||{},d)};e.createAdaptorServer=n;var o=a=>{let l=(0,e.createAdaptorServer)(a);return l.listen(a.port||3e3,a.hostname||"0.0.0.0"),l};e.serve=o}),S=f(e=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createAdaptorServer=e.serve=void 0;var r=N();Object.defineProperty(e,"serve",{enumerable:!0,get:function(){return r.serve}}),Object.defineProperty(e,"createAdaptorServer",{enumerable:!0,get:function(){return r.createAdaptorServer}})}),P={};G(P,{__esModule:()=>z,createAdaptorServer:()=>I,default:()=>Q,serve:()=>J});var R=w(S());T(P,w(S()));var z=!0,{createAdaptorServer:I,serve:J}=R,{default:O,...K}=R,Q=O!==void 0?O:K;export{z as __esModule,I as createAdaptorServer,Q as default,J as serve};
//# sourceMappingURL=node-server.bundle.mjs.map