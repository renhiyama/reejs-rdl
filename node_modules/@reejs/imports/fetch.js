var qe=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(n,i)=>(typeof require<"u"?require:n)[i]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});import ha from"node:worker_threads";import ba from"node:stream/web";import pa from"node:process";import ya from"node:buffer";import{statSync as wn,createReadStream as qa,promises as Oa}from"node:fs";import{basename as ka}from"node:path";import Fa from"node:http";import Ma from"node:https";import Ue from"node:zlib";import An,{PassThrough as Cn,pipeline as He}from"node:stream";import{Buffer as Yt}from"node:buffer";import ge,{PassThrough as qn}from"node:stream";import{types as zn,deprecate as Gr,promisify as Ua}from"node:util";import{Buffer as Y}from"node:buffer";import{types as On}from"node:util";import Xt from"node:http";import{format as Za}from"node:url";import{deprecate as es}from"node:util";import{isIP as rs}from"node:net";var ma=Object.create,Vr=Object.defineProperty,_a=Object.getOwnPropertyDescriptor,ga=Object.getOwnPropertyNames,wa=Object.getPrototypeOf,Sa=Object.prototype.hasOwnProperty,ws=(r=>typeof qe<"u"?qe:typeof Proxy<"u"?new Proxy(r,{get:(n,i)=>(typeof qe<"u"?qe:n)[i]}):r)(function(r){if(typeof qe<"u")return qe.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')}),ht=(r,n)=>()=>(r&&(n=r(r=0)),n),Yr=(r,n)=>()=>(n||r((n={exports:{}}).exports,n),n.exports),va=(r,n)=>{for(var i in n)Vr(r,i,{get:n[i],enumerable:!0})},Ra=(r,n,i,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let u of ga(n))!Sa.call(r,u)&&u!==i&&Vr(r,u,{get:()=>n[u],enumerable:!(s=_a(n,u))||s.enumerable});return r},Ln=(r,n,i)=>(i=r!=null?ma(wa(r)):{},Ra(n||!r||!r.__esModule?Vr(i,"default",{value:r,enumerable:!0}):i,r)),Ta=Yr((r,n)=>{(function(i,s){typeof r=="object"&&typeof n<"u"?s(r):typeof define=="function"&&define.amd?define(["exports"],s):(i=typeof globalThis<"u"?globalThis:i||self,s(i.WebStreamsPolyfill={}))})(r,function(i){"use strict";let s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function u(){}function d(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let y=d();function h(e){return typeof e=="object"&&e!==null||typeof e=="function"}let v=u,m=Promise,B=Promise.prototype.then,$=Promise.resolve.bind(m),j=Promise.reject.bind(m);function g(e){return new m(e)}function b(e){return $(e)}function p(e){return j(e)}function E(e,t,o){return B.call(e,t,o)}function S(e,t,o){E(E(e,t,o),void 0,v)}function F(e,t){S(e,t)}function M(e,t){S(e,void 0,t)}function q(e,t,o){return E(e,t,o)}function L(e){E(e,void 0,v)}let D=(()=>{let e=y&&y.queueMicrotask;if(typeof e=="function")return e;let t=b(void 0);return o=>E(t,o)})();function Se(e,t,o){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,o)}function oe(e,t,o){try{return b(Se(e,t,o))}catch(a){return p(a)}}let Kr=16384;class Q{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let o=this._back,a=o;o._elements.length===Kr-1&&(a={_elements:[],_next:void 0}),o._elements.push(t),a!==o&&(this._back=a,o._next=a),++this._size}shift(){let t=this._front,o=t,a=this._cursor,l=a+1,c=t._elements,f=c[a];return l===Kr&&(o=t._next,l=0),--this._size,this._cursor=l,t!==o&&(this._front=o),c[a]=void 0,f}forEach(t){let o=this._cursor,a=this._front,l=a._elements;for(;(o!==l.length||a._next!==void 0)&&!(o===l.length&&(a=a._next,l=a._elements,o=0,l.length===0));)t(l[o]),++o}peek(){let t=this._front,o=this._cursor;return t._elements[o]}}function Xr(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?nr(e):t._state==="closed"?xn(e):Zr(e,t._storedError)}function or(e,t){let o=e._ownerReadableStream;return K(o,t)}function ne(e){e._ownerReadableStream._state==="readable"?ir(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Un(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function Oe(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function nr(e){e._closedPromise=g((t,o)=>{e._closedPromise_resolve=t,e._closedPromise_reject=o})}function Zr(e,t){nr(e),ir(e,t)}function xn(e){nr(e),eo(e)}function ir(e,t){e._closedPromise_reject!==void 0&&(L(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function Un(e,t){Zr(e,t)}function eo(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let to=s("[[AbortSteps]]"),ro=s("[[ErrorSteps]]"),ar=s("[[CancelSteps]]"),sr=s("[[PullSteps]]"),oo=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},Hn=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function Nn(e){return typeof e=="object"||typeof e=="function"}function ie(e,t){if(e!==void 0&&!Nn(e))throw new TypeError(`${t} is not an object.`)}function G(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function Vn(e){return typeof e=="object"&&e!==null||typeof e=="function"}function no(e,t){if(!Vn(e))throw new TypeError(`${t} is not an object.`)}function ae(e,t,o){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${o}'.`)}function lr(e,t,o){if(e===void 0)throw new TypeError(`${t} is required in '${o}'.`)}function ur(e){return Number(e)}function io(e){return e===0?0:e}function Yn(e){return io(Hn(e))}function ao(e,t){let o=Number.MAX_SAFE_INTEGER,a=Number(e);if(a=io(a),!oo(a))throw new TypeError(`${t} is not a finite number`);if(a=Yn(a),a<0||a>o)throw new TypeError(`${t} is outside the accepted range of 0 to ${o}, inclusive`);return!oo(a)||a===0?0:a}function cr(e,t){if(!he(e))throw new TypeError(`${t} is not a ReadableStream.`)}function ke(e){return new Ye(e)}function so(e,t){e._reader._readRequests.push(t)}function dr(e,t,o){let a=e._reader._readRequests.shift();o?a._closeSteps():a._chunkSteps(t)}function bt(e){return e._reader._readRequests.length}function lo(e){let t=e._reader;return!(t===void 0||!ue(t))}class Ye{constructor(t){if(ae(t,1,"ReadableStreamDefaultReader"),cr(t,"First parameter"),be(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Xr(this,t),this._readRequests=new Q}get closed(){return ue(this)?this._closedPromise:p(pt("closed"))}cancel(t=void 0){return ue(this)?this._ownerReadableStream===void 0?p(Oe("cancel")):or(this,t):p(pt("cancel"))}read(){if(!ue(this))return p(pt("read"));if(this._ownerReadableStream===void 0)return p(Oe("read from"));let t,o,a=g((l,c)=>{t=l,o=c});return Qe(this,{_chunkSteps:l=>t({value:l,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:l=>o(l)}),a}releaseLock(){if(!ue(this))throw pt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ne(this)}}}Object.defineProperties(Ye.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(Ye.prototype,s.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function ue(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Ye}function Qe(e,t){let o=e._ownerReadableStream;o._disturbed=!0,o._state==="closed"?t._closeSteps():o._state==="errored"?t._errorSteps(o._storedError):o._readableStreamController[sr](t)}function pt(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let uo=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class co{constructor(t,o){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=o}next(){let t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?q(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){let o=()=>this._returnSteps(t);return this._ongoingPromise?q(this._ongoingPromise,o,o):o()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let t=this._reader;if(t._ownerReadableStream===void 0)return p(Oe("iterate"));let o,a,l=g((c,f)=>{o=c,a=f});return Qe(t,{_chunkSteps:c=>{this._ongoingPromise=void 0,D(()=>o({value:c,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ne(t),o({value:void 0,done:!0})},_errorSteps:c=>{this._ongoingPromise=void 0,this._isFinished=!0,ne(t),a(c)}}),l}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let o=this._reader;if(o._ownerReadableStream===void 0)return p(Oe("finish iterating"));if(!this._preventCancel){let a=or(o,t);return ne(o),q(a,()=>({value:t,done:!0}))}return ne(o),b({value:t,done:!0})}}let fo={next(){return ho(this)?this._asyncIteratorImpl.next():p(bo("next"))},return(e){return ho(this)?this._asyncIteratorImpl.return(e):p(bo("return"))}};uo!==void 0&&Object.setPrototypeOf(fo,uo);function Qn(e,t){let o=ke(e),a=new co(o,t),l=Object.create(fo);return l._asyncIteratorImpl=a,l}function ho(e){if(!h(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof co}catch{return!1}}function bo(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let po=Number.isNaN||function(e){return e!==e};function Ge(e){return e.slice()}function yo(e,t,o,a,l){new Uint8Array(e).set(new Uint8Array(o,a,l),t)}function bs(e){return e}function yt(e){return!1}function mo(e,t,o){if(e.slice)return e.slice(t,o);let a=o-t,l=new ArrayBuffer(a);return yo(l,0,e,t,a),l}function Gn(e){return!(typeof e!="number"||po(e)||e<0)}function _o(e){let t=mo(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function fr(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function hr(e,t,o){if(!Gn(o)||o===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:o}),e._queueTotalSize+=o}function Jn(e){return e._queue.peek().value}function ce(e){e._queue=new Q,e._queueTotalSize=0}class Je{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!br(this))throw _r("view");return this._view}respond(t){if(!br(this))throw _r("respond");if(ae(t,1,"respond"),t=ao(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");yt(this._view.buffer),St(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!br(this))throw _r("respondWithNewView");if(ae(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");yt(t.buffer),vt(this._associatedReadableByteStreamController,t)}}Object.defineProperties(Je.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(Je.prototype,s.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Le{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!ve(this))throw Xe("byobRequest");return mr(this)}get desiredSize(){if(!ve(this))throw Xe("desiredSize");return Po(this)}close(){if(!ve(this))throw Xe("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);Ke(this)}enqueue(t){if(!ve(this))throw Xe("enqueue");if(ae(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let o=this._controlledReadableByteStream._state;if(o!=="readable")throw new TypeError(`The stream (in ${o} state) is not in the readable state and cannot be enqueued to`);wt(this,t)}error(t=void 0){if(!ve(this))throw Xe("error");J(this,t)}[ar](t){go(this),ce(this);let o=this._cancelAlgorithm(t);return gt(this),o}[sr](t){let o=this._controlledReadableByteStream;if(this._queueTotalSize>0){let l=this._queue.shift();this._queueTotalSize-=l.byteLength,Ro(this);let c=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);t._chunkSteps(c);return}let a=this._autoAllocateChunkSize;if(a!==void 0){let l;try{l=new ArrayBuffer(a)}catch(f){t._errorSteps(f);return}let c={buffer:l,bufferByteLength:a,byteOffset:0,byteLength:a,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(c)}so(o,t),Re(this)}}Object.defineProperties(Le.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(Le.prototype,s.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function ve(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof Le}function br(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof Je}function Re(e){if(!ei(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let t=e._pullAlgorithm();S(t,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Re(e))},o=>{J(e,o)})}function go(e){yr(e),e._pendingPullIntos=new Q}function pr(e,t){let o=!1;e._state==="closed"&&(o=!0);let a=wo(t);t.readerType==="default"?dr(e,a,o):oi(e,a,o)}function wo(e){let t=e.bytesFilled,o=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/o)}function mt(e,t,o,a){e._queue.push({buffer:t,byteOffset:o,byteLength:a}),e._queueTotalSize+=a}function So(e,t){let o=t.elementSize,a=t.bytesFilled-t.bytesFilled%o,l=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),c=t.bytesFilled+l,f=c-c%o,_=l,R=!1;f>a&&(_=f-t.bytesFilled,R=!0);let T=e._queue;for(;_>0;){let A=T.peek(),C=Math.min(_,A.byteLength),W=t.byteOffset+t.bytesFilled;yo(t.buffer,W,A.buffer,A.byteOffset,C),A.byteLength===C?T.shift():(A.byteOffset+=C,A.byteLength-=C),e._queueTotalSize-=C,vo(e,C,t),_-=C}return R}function vo(e,t,o){o.bytesFilled+=t}function Ro(e){e._queueTotalSize===0&&e._closeRequested?(gt(e),at(e._controlledReadableByteStream)):Re(e)}function yr(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function To(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let t=e._pendingPullIntos.peek();So(e,t)&&(_t(e),pr(e._controlledReadableByteStream,t))}}function Kn(e,t,o){let a=e._controlledReadableByteStream,l=1;t.constructor!==DataView&&(l=t.constructor.BYTES_PER_ELEMENT);let c=t.constructor,f=t.buffer,_={buffer:f,bufferByteLength:f.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:l,viewConstructor:c,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(_),qo(a,o);return}if(a._state==="closed"){let R=new c(_.buffer,_.byteOffset,0);o._closeSteps(R);return}if(e._queueTotalSize>0){if(So(e,_)){let R=wo(_);Ro(e),o._chunkSteps(R);return}if(e._closeRequested){let R=new TypeError("Insufficient bytes to fill elements in the given buffer");J(e,R),o._errorSteps(R);return}}e._pendingPullIntos.push(_),qo(a,o),Re(e)}function Xn(e,t){let o=e._controlledReadableByteStream;if(gr(o))for(;Oo(o)>0;){let a=_t(e);pr(o,a)}}function Zn(e,t,o){if(vo(e,t,o),o.bytesFilled<o.elementSize)return;_t(e);let a=o.bytesFilled%o.elementSize;if(a>0){let l=o.byteOffset+o.bytesFilled,c=mo(o.buffer,l-a,l);mt(e,c,0,c.byteLength)}o.bytesFilled-=a,pr(e._controlledReadableByteStream,o),To(e)}function Eo(e,t){let o=e._pendingPullIntos.peek();yr(e),e._controlledReadableByteStream._state==="closed"?Xn(e):Zn(e,t,o),Re(e)}function _t(e){return e._pendingPullIntos.shift()}function ei(e){let t=e._controlledReadableByteStream;return t._state!=="readable"||e._closeRequested||!e._started?!1:!!(lo(t)&&bt(t)>0||gr(t)&&Oo(t)>0||Po(e)>0)}function gt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Ke(e){let t=e._controlledReadableByteStream;if(!(e._closeRequested||t._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let o=new TypeError("Insufficient bytes to fill elements in the given buffer");throw J(e,o),o}gt(e),at(t)}}function wt(e,t){let o=e._controlledReadableByteStream;if(e._closeRequested||o._state!=="readable")return;let a=t.buffer,l=t.byteOffset,c=t.byteLength,f=a;if(e._pendingPullIntos.length>0){let _=e._pendingPullIntos.peek();yt(_.buffer),_.buffer=_.buffer}if(yr(e),lo(o))if(bt(o)===0)mt(e,f,l,c);else{e._pendingPullIntos.length>0&&_t(e);let _=new Uint8Array(f,l,c);dr(o,_,!1)}else gr(o)?(mt(e,f,l,c),To(e)):mt(e,f,l,c);Re(e)}function J(e,t){let o=e._controlledReadableByteStream;o._state==="readable"&&(go(e),ce(e),gt(e),en(o,t))}function mr(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),o=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),a=Object.create(Je.prototype);ri(a,e,o),e._byobRequest=a}return e._byobRequest}function Po(e){let t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function St(e,t){let o=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(o.bytesFilled+t>o.byteLength)throw new RangeError("bytesWritten out of range")}o.buffer=o.buffer,Eo(e,t)}function vt(e,t){let o=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(o.byteOffset+o.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(o.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(o.bytesFilled+t.byteLength>o.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let a=t.byteLength;o.buffer=t.buffer,Eo(e,a)}function Ao(e,t,o,a,l,c,f){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,ce(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=c,t._pullAlgorithm=a,t._cancelAlgorithm=l,t._autoAllocateChunkSize=f,t._pendingPullIntos=new Q,e._readableStreamController=t;let _=o();S(b(_),()=>{t._started=!0,Re(t)},R=>{J(t,R)})}function ti(e,t,o){let a=Object.create(Le.prototype),l=()=>{},c=()=>b(void 0),f=()=>b(void 0);t.start!==void 0&&(l=()=>t.start(a)),t.pull!==void 0&&(c=()=>t.pull(a)),t.cancel!==void 0&&(f=R=>t.cancel(R));let _=t.autoAllocateChunkSize;if(_===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Ao(e,a,l,c,f,o,_)}function ri(e,t,o){e._associatedReadableByteStreamController=t,e._view=o}function _r(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Xe(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Co(e){return new Ze(e)}function qo(e,t){e._reader._readIntoRequests.push(t)}function oi(e,t,o){let a=e._reader._readIntoRequests.shift();o?a._closeSteps(t):a._chunkSteps(t)}function Oo(e){return e._reader._readIntoRequests.length}function gr(e){let t=e._reader;return!(t===void 0||!Te(t))}class Ze{constructor(t){if(ae(t,1,"ReadableStreamBYOBReader"),cr(t,"First parameter"),be(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!ve(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Xr(this,t),this._readIntoRequests=new Q}get closed(){return Te(this)?this._closedPromise:p(Rt("closed"))}cancel(t=void 0){return Te(this)?this._ownerReadableStream===void 0?p(Oe("cancel")):or(this,t):p(Rt("cancel"))}read(t){if(!Te(this))return p(Rt("read"));if(!ArrayBuffer.isView(t))return p(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return p(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return p(new TypeError("view's buffer must have non-zero byteLength"));if(yt(t.buffer),this._ownerReadableStream===void 0)return p(Oe("read from"));let o,a,l=g((c,f)=>{o=c,a=f});return ko(this,t,{_chunkSteps:c=>o({value:c,done:!1}),_closeSteps:c=>o({value:c,done:!0}),_errorSteps:c=>a(c)}),l}releaseLock(){if(!Te(this))throw Rt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ne(this)}}}Object.defineProperties(Ze.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(Ze.prototype,s.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Te(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Ze}function ko(e,t,o){let a=e._ownerReadableStream;a._disturbed=!0,a._state==="errored"?o._errorSteps(a._storedError):Kn(a._readableStreamController,t,o)}function Rt(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function et(e,t){let{highWaterMark:o}=e;if(o===void 0)return t;if(po(o)||o<0)throw new RangeError("Invalid highWaterMark");return o}function Tt(e){let{size:t}=e;return t||(()=>1)}function Et(e,t){ie(e,t);let o=e?.highWaterMark,a=e?.size;return{highWaterMark:o===void 0?void 0:ur(o),size:a===void 0?void 0:ni(a,`${t} has member 'size' that`)}}function ni(e,t){return G(e,t),o=>ur(e(o))}function ii(e,t){ie(e,t);let o=e?.abort,a=e?.close,l=e?.start,c=e?.type,f=e?.write;return{abort:o===void 0?void 0:ai(o,e,`${t} has member 'abort' that`),close:a===void 0?void 0:si(a,e,`${t} has member 'close' that`),start:l===void 0?void 0:li(l,e,`${t} has member 'start' that`),write:f===void 0?void 0:ui(f,e,`${t} has member 'write' that`),type:c}}function ai(e,t,o){return G(e,o),a=>oe(e,t,[a])}function si(e,t,o){return G(e,o),()=>oe(e,t,[])}function li(e,t,o){return G(e,o),a=>Se(e,t,[a])}function ui(e,t,o){return G(e,o),(a,l)=>oe(e,t,[a,l])}function Lo(e,t){if(!Be(e))throw new TypeError(`${t} is not a WritableStream.`)}function ci(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let di=typeof AbortController=="function";function fi(){if(di)return new AbortController}class tt{constructor(t={},o={}){t===void 0?t=null:no(t,"First parameter");let a=Et(o,"Second parameter"),l=ii(t,"First parameter");if(jo(this),l.type!==void 0)throw new RangeError("Invalid type is specified");let c=Tt(a),f=et(a,1);Pi(this,l,f,c)}get locked(){if(!Be(this))throw Ot("locked");return je(this)}abort(t=void 0){return Be(this)?je(this)?p(new TypeError("Cannot abort a stream that already has a writer")):Pt(this,t):p(Ot("abort"))}close(){return Be(this)?je(this)?p(new TypeError("Cannot close a stream that already has a writer")):te(this)?p(new TypeError("Cannot close an already-closing stream")):Do(this):p(Ot("close"))}getWriter(){if(!Be(this))throw Ot("getWriter");return Bo(this)}}Object.defineProperties(tt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(tt.prototype,s.toStringTag,{value:"WritableStream",configurable:!0});function Bo(e){return new rt(e)}function hi(e,t,o,a,l=1,c=()=>1){let f=Object.create(tt.prototype);jo(f);let _=Object.create(De.prototype);return Io(f,_,e,t,o,a,l,c),f}function jo(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new Q,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function Be(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof tt}function je(e){return e._writer!==void 0}function Pt(e,t){var o;if(e._state==="closed"||e._state==="errored")return b(void 0);e._writableStreamController._abortReason=t,(o=e._writableStreamController._abortController)===null||o===void 0||o.abort();let a=e._state;if(a==="closed"||a==="errored")return b(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let l=!1;a==="erroring"&&(l=!0,t=void 0);let c=g((f,_)=>{e._pendingAbortRequest={_promise:void 0,_resolve:f,_reject:_,_reason:t,_wasAlreadyErroring:l}});return e._pendingAbortRequest._promise=c,l||Sr(e,t),c}function Do(e){let t=e._state;if(t==="closed"||t==="errored")return p(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));let o=g((l,c)=>{let f={_resolve:l,_reject:c};e._closeRequest=f}),a=e._writer;return a!==void 0&&e._backpressure&&t==="writable"&&Or(a),Ai(e._writableStreamController),o}function bi(e){return g((t,o)=>{let a={_resolve:t,_reject:o};e._writeRequests.push(a)})}function wr(e,t){if(e._state==="writable"){Sr(e,t);return}vr(e)}function Sr(e,t){let o=e._writableStreamController;e._state="erroring",e._storedError=t;let a=e._writer;a!==void 0&&zo(a,t),!gi(e)&&o._started&&vr(e)}function vr(e){e._state="errored",e._writableStreamController[ro]();let t=e._storedError;if(e._writeRequests.forEach(l=>{l._reject(t)}),e._writeRequests=new Q,e._pendingAbortRequest===void 0){At(e);return}let o=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,o._wasAlreadyErroring){o._reject(t),At(e);return}let a=e._writableStreamController[to](o._reason);S(a,()=>{o._resolve(),At(e)},l=>{o._reject(l),At(e)})}function pi(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function yi(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,wr(e,t)}function mi(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let t=e._writer;t!==void 0&&No(t)}function _i(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),wr(e,t)}function te(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function gi(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function wi(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Si(e){e._inFlightWriteRequest=e._writeRequests.shift()}function At(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;t!==void 0&&Cr(t,e._storedError)}function Rr(e,t){let o=e._writer;o!==void 0&&t!==e._backpressure&&(t?ji(o):Or(o)),e._backpressure=t}class rt{constructor(t){if(ae(t,1,"WritableStreamDefaultWriter"),Lo(t,"First parameter"),je(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let o=t._state;if(o==="writable")!te(t)&&t._backpressure?Lt(this):Vo(this),kt(this);else if(o==="erroring")qr(this,t._storedError),kt(this);else if(o==="closed")Vo(this),Li(this);else{let a=t._storedError;qr(this,a),Ho(this,a)}}get closed(){return Ee(this)?this._closedPromise:p(Pe("closed"))}get desiredSize(){if(!Ee(this))throw Pe("desiredSize");if(this._ownerWritableStream===void 0)throw ot("desiredSize");return Ei(this)}get ready(){return Ee(this)?this._readyPromise:p(Pe("ready"))}abort(t=void 0){return Ee(this)?this._ownerWritableStream===void 0?p(ot("abort")):vi(this,t):p(Pe("abort"))}close(){if(!Ee(this))return p(Pe("close"));let t=this._ownerWritableStream;return t===void 0?p(ot("close")):te(t)?p(new TypeError("Cannot close an already-closing stream")):Wo(this)}releaseLock(){if(!Ee(this))throw Pe("releaseLock");this._ownerWritableStream!==void 0&&$o(this)}write(t=void 0){return Ee(this)?this._ownerWritableStream===void 0?p(ot("write to")):Fo(this,t):p(Pe("write"))}}Object.defineProperties(rt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(rt.prototype,s.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Ee(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof rt}function vi(e,t){let o=e._ownerWritableStream;return Pt(o,t)}function Wo(e){let t=e._ownerWritableStream;return Do(t)}function Ri(e){let t=e._ownerWritableStream,o=t._state;return te(t)||o==="closed"?b(void 0):o==="errored"?p(t._storedError):Wo(e)}function Ti(e,t){e._closedPromiseState==="pending"?Cr(e,t):Bi(e,t)}function zo(e,t){e._readyPromiseState==="pending"?Yo(e,t):Di(e,t)}function Ei(e){let t=e._ownerWritableStream,o=t._state;return o==="errored"||o==="erroring"?null:o==="closed"?0:xo(t._writableStreamController)}function $o(e){let t=e._ownerWritableStream,o=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");zo(e,o),Ti(e,o),t._writer=void 0,e._ownerWritableStream=void 0}function Fo(e,t){let o=e._ownerWritableStream,a=o._writableStreamController,l=Ci(a,t);if(o!==e._ownerWritableStream)return p(ot("write to"));let c=o._state;if(c==="errored")return p(o._storedError);if(te(o)||c==="closed")return p(new TypeError("The stream is closing or closed and cannot be written to"));if(c==="erroring")return p(o._storedError);let f=bi(o);return qi(a,t,l),f}let Mo={};class De{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Tr(this))throw Ar("abortReason");return this._abortReason}get signal(){if(!Tr(this))throw Ar("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!Tr(this))throw Ar("error");this._controlledWritableStream._state==="writable"&&Uo(this,t)}[to](t){let o=this._abortAlgorithm(t);return Ct(this),o}[ro](){ce(this)}}Object.defineProperties(De.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(De.prototype,s.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Tr(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof De}function Io(e,t,o,a,l,c,f,_){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,ce(t),t._abortReason=void 0,t._abortController=fi(),t._started=!1,t._strategySizeAlgorithm=_,t._strategyHWM=f,t._writeAlgorithm=a,t._closeAlgorithm=l,t._abortAlgorithm=c;let R=Pr(t);Rr(e,R);let T=o(),A=b(T);S(A,()=>{t._started=!0,qt(t)},C=>{t._started=!0,wr(e,C)})}function Pi(e,t,o,a){let l=Object.create(De.prototype),c=()=>{},f=()=>b(void 0),_=()=>b(void 0),R=()=>b(void 0);t.start!==void 0&&(c=()=>t.start(l)),t.write!==void 0&&(f=T=>t.write(T,l)),t.close!==void 0&&(_=()=>t.close()),t.abort!==void 0&&(R=T=>t.abort(T)),Io(e,l,c,f,_,R,o,a)}function Ct(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Ai(e){hr(e,Mo,0),qt(e)}function Ci(e,t){try{return e._strategySizeAlgorithm(t)}catch(o){return Er(e,o),1}}function xo(e){return e._strategyHWM-e._queueTotalSize}function qi(e,t,o){try{hr(e,t,o)}catch(l){Er(e,l);return}let a=e._controlledWritableStream;if(!te(a)&&a._state==="writable"){let l=Pr(e);Rr(a,l)}qt(e)}function qt(e){let t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring"){vr(t);return}if(e._queue.length===0)return;let o=Jn(e);o===Mo?Oi(e):ki(e,o)}function Er(e,t){e._controlledWritableStream._state==="writable"&&Uo(e,t)}function Oi(e){let t=e._controlledWritableStream;wi(t),fr(e);let o=e._closeAlgorithm();Ct(e),S(o,()=>{mi(t)},a=>{_i(t,a)})}function ki(e,t){let o=e._controlledWritableStream;Si(o);let a=e._writeAlgorithm(t);S(a,()=>{pi(o);let l=o._state;if(fr(e),!te(o)&&l==="writable"){let c=Pr(e);Rr(o,c)}qt(e)},l=>{o._state==="writable"&&Ct(e),yi(o,l)})}function Pr(e){return xo(e)<=0}function Uo(e,t){let o=e._controlledWritableStream;Ct(e),Sr(o,t)}function Ot(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Ar(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Pe(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function ot(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function kt(e){e._closedPromise=g((t,o)=>{e._closedPromise_resolve=t,e._closedPromise_reject=o,e._closedPromiseState="pending"})}function Ho(e,t){kt(e),Cr(e,t)}function Li(e){kt(e),No(e)}function Cr(e,t){e._closedPromise_reject!==void 0&&(L(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Bi(e,t){Ho(e,t)}function No(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Lt(e){e._readyPromise=g((t,o)=>{e._readyPromise_resolve=t,e._readyPromise_reject=o}),e._readyPromiseState="pending"}function qr(e,t){Lt(e),Yo(e,t)}function Vo(e){Lt(e),Or(e)}function Yo(e,t){e._readyPromise_reject!==void 0&&(L(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function ji(e){Lt(e)}function Di(e,t){qr(e,t)}function Or(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let Qo=typeof DOMException<"u"?DOMException:void 0;function Wi(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function zi(){let e=function(t,o){this.message=t||"",this.name=o||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let $i=Wi(Qo)?Qo:zi();function Go(e,t,o,a,l,c){let f=ke(e),_=Bo(t);e._disturbed=!0;let R=!1,T=b(void 0);return g((A,C)=>{let W;if(c!==void 0){if(W=()=>{let w=new $i("Aborted","AbortError"),P=[];a||P.push(()=>t._state==="writable"?Pt(t,w):b(void 0)),l||P.push(()=>e._state==="readable"?K(e,w):b(void 0)),H(()=>Promise.all(P.map(O=>O())),!0,w)},c.aborted){W();return}c.addEventListener("abort",W)}function X(){return g((w,P)=>{function O(x){x?w():E($e(),O,P)}O(!1)})}function $e(){return R?b(!0):E(_._readyPromise,()=>g((w,P)=>{Qe(f,{_chunkSteps:O=>{T=E(Fo(_,O),void 0,u),w(!1)},_closeSteps:()=>w(!0),_errorSteps:P})}))}if(se(e,f._closedPromise,w=>{a?N(!0,w):H(()=>Pt(t,w),!0,w)}),se(t,_._closedPromise,w=>{l?N(!0,w):H(()=>K(e,w),!0,w)}),I(e,f._closedPromise,()=>{o?N():H(()=>Ri(_))}),te(t)||t._state==="closed"){let w=new TypeError("the destination writable stream closed before all data could be piped to it");l?N(!0,w):H(()=>K(e,w),!0,w)}L(X());function pe(){let w=T;return E(T,()=>w!==T?pe():void 0)}function se(w,P,O){w._state==="errored"?O(w._storedError):M(P,O)}function I(w,P,O){w._state==="closed"?O():F(P,O)}function H(w,P,O){if(R)return;R=!0,t._state==="writable"&&!te(t)?F(pe(),x):x();function x(){S(w(),()=>Ce(P,O),ye=>Ce(!0,ye))}}function N(w,P){R||(R=!0,t._state==="writable"&&!te(t)?F(pe(),()=>Ce(w,P)):Ce(w,P))}function Ce(w,P){$o(_),ne(f),c!==void 0&&c.removeEventListener("abort",W),w?C(P):A(void 0)}})}class We{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Bt(this))throw Wt("desiredSize");return kr(this)}close(){if(!Bt(this))throw Wt("close");if(!ze(this))throw new TypeError("The stream is not in a state that permits close");it(this)}enqueue(t=void 0){if(!Bt(this))throw Wt("enqueue");if(!ze(this))throw new TypeError("The stream is not in a state that permits enqueue");return Dt(this,t)}error(t=void 0){if(!Bt(this))throw Wt("error");de(this,t)}[ar](t){ce(this);let o=this._cancelAlgorithm(t);return jt(this),o}[sr](t){let o=this._controlledReadableStream;if(this._queue.length>0){let a=fr(this);this._closeRequested&&this._queue.length===0?(jt(this),at(o)):nt(this),t._chunkSteps(a)}else so(o,t),nt(this)}}Object.defineProperties(We.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(We.prototype,s.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Bt(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof We}function nt(e){if(!Jo(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let t=e._pullAlgorithm();S(t,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,nt(e))},o=>{de(e,o)})}function Jo(e){let t=e._controlledReadableStream;return!ze(e)||!e._started?!1:!!(be(t)&&bt(t)>0||kr(e)>0)}function jt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function it(e){if(!ze(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(jt(e),at(t))}function Dt(e,t){if(!ze(e))return;let o=e._controlledReadableStream;if(be(o)&&bt(o)>0)dr(o,t,!1);else{let a;try{a=e._strategySizeAlgorithm(t)}catch(l){throw de(e,l),l}try{hr(e,t,a)}catch(l){throw de(e,l),l}}nt(e)}function de(e,t){let o=e._controlledReadableStream;o._state==="readable"&&(ce(e),jt(e),en(o,t))}function kr(e){let t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Fi(e){return!Jo(e)}function ze(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function Ko(e,t,o,a,l,c,f){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,ce(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=f,t._strategyHWM=c,t._pullAlgorithm=a,t._cancelAlgorithm=l,e._readableStreamController=t;let _=o();S(b(_),()=>{t._started=!0,nt(t)},R=>{de(t,R)})}function Mi(e,t,o,a){let l=Object.create(We.prototype),c=()=>{},f=()=>b(void 0),_=()=>b(void 0);t.start!==void 0&&(c=()=>t.start(l)),t.pull!==void 0&&(f=()=>t.pull(l)),t.cancel!==void 0&&(_=R=>t.cancel(R)),Ko(e,l,c,f,_,o,a)}function Wt(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function Ii(e,t){return ve(e._readableStreamController)?Ui(e):xi(e)}function xi(e,t){let o=ke(e),a=!1,l=!1,c=!1,f=!1,_,R,T,A,C,W=g(I=>{C=I});function X(){return a?(l=!0,b(void 0)):(a=!0,Qe(o,{_chunkSteps:I=>{D(()=>{l=!1;let H=I,N=I;c||Dt(T._readableStreamController,H),f||Dt(A._readableStreamController,N),a=!1,l&&X()})},_closeSteps:()=>{a=!1,c||it(T._readableStreamController),f||it(A._readableStreamController),(!c||!f)&&C(void 0)},_errorSteps:()=>{a=!1}}),b(void 0))}function $e(I){if(c=!0,_=I,f){let H=Ge([_,R]),N=K(e,H);C(N)}return W}function pe(I){if(f=!0,R=I,c){let H=Ge([_,R]),N=K(e,H);C(N)}return W}function se(){}return T=Lr(se,X,$e),A=Lr(se,X,pe),M(o._closedPromise,I=>{de(T._readableStreamController,I),de(A._readableStreamController,I),(!c||!f)&&C(void 0)}),[T,A]}function Ui(e){let t=ke(e),o=!1,a=!1,l=!1,c=!1,f=!1,_,R,T,A,C,W=g(w=>{C=w});function X(w){M(w._closedPromise,P=>{w===t&&(J(T._readableStreamController,P),J(A._readableStreamController,P),(!c||!f)&&C(void 0))})}function $e(){Te(t)&&(ne(t),t=ke(e),X(t)),Qe(t,{_chunkSteps:w=>{D(()=>{a=!1,l=!1;let P=w,O=w;if(!c&&!f)try{O=_o(w)}catch(x){J(T._readableStreamController,x),J(A._readableStreamController,x),C(K(e,x));return}c||wt(T._readableStreamController,P),f||wt(A._readableStreamController,O),o=!1,a?se():l&&I()})},_closeSteps:()=>{o=!1,c||Ke(T._readableStreamController),f||Ke(A._readableStreamController),T._readableStreamController._pendingPullIntos.length>0&&St(T._readableStreamController,0),A._readableStreamController._pendingPullIntos.length>0&&St(A._readableStreamController,0),(!c||!f)&&C(void 0)},_errorSteps:()=>{o=!1}})}function pe(w,P){ue(t)&&(ne(t),t=Co(e),X(t));let O=P?A:T,x=P?T:A;ko(t,w,{_chunkSteps:ye=>{D(()=>{a=!1,l=!1;let Fe=P?f:c;if(P?c:f)Fe||vt(O._readableStreamController,ye);else{let Me;try{Me=_o(ye)}catch(jr){J(O._readableStreamController,jr),J(x._readableStreamController,jr),C(K(e,jr));return}Fe||vt(O._readableStreamController,ye),wt(x._readableStreamController,Me)}o=!1,a?se():l&&I()})},_closeSteps:ye=>{o=!1;let Fe=P?f:c,Me=P?c:f;Fe||Ke(O._readableStreamController),Me||Ke(x._readableStreamController),ye!==void 0&&(Fe||vt(O._readableStreamController,ye),!Me&&x._readableStreamController._pendingPullIntos.length>0&&St(x._readableStreamController,0)),(!Fe||!Me)&&C(void 0)},_errorSteps:()=>{o=!1}})}function se(){if(o)return a=!0,b(void 0);o=!0;let w=mr(T._readableStreamController);return w===null?$e():pe(w._view,!1),b(void 0)}function I(){if(o)return l=!0,b(void 0);o=!0;let w=mr(A._readableStreamController);return w===null?$e():pe(w._view,!0),b(void 0)}function H(w){if(c=!0,_=w,f){let P=Ge([_,R]),O=K(e,P);C(O)}return W}function N(w){if(f=!0,R=w,c){let P=Ge([_,R]),O=K(e,P);C(O)}return W}function Ce(){}return T=Zo(Ce,se,H),A=Zo(Ce,I,N),X(t),[T,A]}function Hi(e,t){ie(e,t);let o=e,a=o?.autoAllocateChunkSize,l=o?.cancel,c=o?.pull,f=o?.start,_=o?.type;return{autoAllocateChunkSize:a===void 0?void 0:ao(a,`${t} has member 'autoAllocateChunkSize' that`),cancel:l===void 0?void 0:Ni(l,o,`${t} has member 'cancel' that`),pull:c===void 0?void 0:Vi(c,o,`${t} has member 'pull' that`),start:f===void 0?void 0:Yi(f,o,`${t} has member 'start' that`),type:_===void 0?void 0:Qi(_,`${t} has member 'type' that`)}}function Ni(e,t,o){return G(e,o),a=>oe(e,t,[a])}function Vi(e,t,o){return G(e,o),a=>oe(e,t,[a])}function Yi(e,t,o){return G(e,o),a=>Se(e,t,[a])}function Qi(e,t){if(e=`${e}`,e!=="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Gi(e,t){ie(e,t);let o=e?.mode;return{mode:o===void 0?void 0:Ji(o,`${t} has member 'mode' that`)}}function Ji(e,t){if(e=`${e}`,e!=="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function Ki(e,t){ie(e,t);let o=e?.preventCancel;return{preventCancel:Boolean(o)}}function Xo(e,t){ie(e,t);let o=e?.preventAbort,a=e?.preventCancel,l=e?.preventClose,c=e?.signal;return c!==void 0&&Xi(c,`${t} has member 'signal' that`),{preventAbort:Boolean(o),preventCancel:Boolean(a),preventClose:Boolean(l),signal:c}}function Xi(e,t){if(!ci(e))throw new TypeError(`${t} is not an AbortSignal.`)}function Zi(e,t){ie(e,t);let o=e?.readable;lr(o,"readable","ReadableWritablePair"),cr(o,`${t} has member 'readable' that`);let a=e?.writable;return lr(a,"writable","ReadableWritablePair"),Lo(a,`${t} has member 'writable' that`),{readable:o,writable:a}}class fe{constructor(t={},o={}){t===void 0?t=null:no(t,"First parameter");let a=Et(o,"Second parameter"),l=Hi(t,"First parameter");if(Br(this),l.type==="bytes"){if(a.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let c=et(a,0);ti(this,l,c)}else{let c=Tt(a),f=et(a,1);Mi(this,l,f,c)}}get locked(){if(!he(this))throw Ae("locked");return be(this)}cancel(t=void 0){return he(this)?be(this)?p(new TypeError("Cannot cancel a stream that already has a reader")):K(this,t):p(Ae("cancel"))}getReader(t=void 0){if(!he(this))throw Ae("getReader");return Gi(t,"First parameter").mode===void 0?ke(this):Co(this)}pipeThrough(t,o={}){if(!he(this))throw Ae("pipeThrough");ae(t,1,"pipeThrough");let a=Zi(t,"First parameter"),l=Xo(o,"Second parameter");if(be(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(je(a.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let c=Go(this,a.writable,l.preventClose,l.preventAbort,l.preventCancel,l.signal);return L(c),a.readable}pipeTo(t,o={}){if(!he(this))return p(Ae("pipeTo"));if(t===void 0)return p("Parameter 1 is required in 'pipeTo'.");if(!Be(t))return p(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let a;try{a=Xo(o,"Second parameter")}catch(l){return p(l)}return be(this)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):je(t)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Go(this,t,a.preventClose,a.preventAbort,a.preventCancel,a.signal)}tee(){if(!he(this))throw Ae("tee");let t=Ii(this);return Ge(t)}values(t=void 0){if(!he(this))throw Ae("values");let o=Ki(t,"First parameter");return Qn(this,o.preventCancel)}}Object.defineProperties(fe.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(fe.prototype,s.toStringTag,{value:"ReadableStream",configurable:!0}),typeof s.asyncIterator=="symbol"&&Object.defineProperty(fe.prototype,s.asyncIterator,{value:fe.prototype.values,writable:!0,configurable:!0});function Lr(e,t,o,a=1,l=()=>1){let c=Object.create(fe.prototype);Br(c);let f=Object.create(We.prototype);return Ko(c,f,e,t,o,a,l),c}function Zo(e,t,o){let a=Object.create(fe.prototype);Br(a);let l=Object.create(Le.prototype);return Ao(a,l,e,t,o,0,void 0),a}function Br(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function he(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof fe}function be(e){return e._reader!==void 0}function K(e,t){if(e._disturbed=!0,e._state==="closed")return b(void 0);if(e._state==="errored")return p(e._storedError);at(e);let o=e._reader;o!==void 0&&Te(o)&&(o._readIntoRequests.forEach(l=>{l._closeSteps(void 0)}),o._readIntoRequests=new Q);let a=e._readableStreamController[ar](t);return q(a,u)}function at(e){e._state="closed";let t=e._reader;t!==void 0&&(eo(t),ue(t)&&(t._readRequests.forEach(o=>{o._closeSteps()}),t._readRequests=new Q))}function en(e,t){e._state="errored",e._storedError=t;let o=e._reader;o!==void 0&&(ir(o,t),ue(o)?(o._readRequests.forEach(a=>{a._errorSteps(t)}),o._readRequests=new Q):(o._readIntoRequests.forEach(a=>{a._errorSteps(t)}),o._readIntoRequests=new Q))}function Ae(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function tn(e,t){ie(e,t);let o=e?.highWaterMark;return lr(o,"highWaterMark","QueuingStrategyInit"),{highWaterMark:ur(o)}}let rn=e=>e.byteLength;try{Object.defineProperty(rn,"name",{value:"size",configurable:!0})}catch{}class zt{constructor(t){ae(t,1,"ByteLengthQueuingStrategy"),t=tn(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!nn(this))throw on("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!nn(this))throw on("size");return rn}}Object.defineProperties(zt.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(zt.prototype,s.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function on(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function nn(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof zt}let an=()=>1;try{Object.defineProperty(an,"name",{value:"size",configurable:!0})}catch{}class $t{constructor(t){ae(t,1,"CountQueuingStrategy"),t=tn(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!ln(this))throw sn("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!ln(this))throw sn("size");return an}}Object.defineProperties($t.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty($t.prototype,s.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function sn(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function ln(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof $t}function ea(e,t){ie(e,t);let o=e?.flush,a=e?.readableType,l=e?.start,c=e?.transform,f=e?.writableType;return{flush:o===void 0?void 0:ta(o,e,`${t} has member 'flush' that`),readableType:a,start:l===void 0?void 0:ra(l,e,`${t} has member 'start' that`),transform:c===void 0?void 0:oa(c,e,`${t} has member 'transform' that`),writableType:f}}function ta(e,t,o){return G(e,o),a=>oe(e,t,[a])}function ra(e,t,o){return G(e,o),a=>Se(e,t,[a])}function oa(e,t,o){return G(e,o),(a,l)=>oe(e,t,[a,l])}class Ft{constructor(t={},o={},a={}){t===void 0&&(t=null);let l=Et(o,"Second parameter"),c=Et(a,"Third parameter"),f=ea(t,"First parameter");if(f.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(f.writableType!==void 0)throw new RangeError("Invalid writableType specified");let _=et(c,0),R=Tt(c),T=et(l,1),A=Tt(l),C,W=g(X=>{C=X});na(this,W,T,A,_,R),aa(this,f),f.start!==void 0?C(f.start(this._transformStreamController)):C(void 0)}get readable(){if(!un(this))throw hn("readable");return this._readable}get writable(){if(!un(this))throw hn("writable");return this._writable}}Object.defineProperties(Ft.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(Ft.prototype,s.toStringTag,{value:"TransformStream",configurable:!0});function na(e,t,o,a,l,c){function f(){return t}function _(W){return ua(e,W)}function R(W){return ca(e,W)}function T(){return da(e)}e._writable=hi(f,_,T,R,o,a);function A(){return fa(e)}function C(W){return It(e,W),b(void 0)}e._readable=Lr(f,A,C,l,c),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,xt(e,!0),e._transformStreamController=void 0}function un(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Ft}function Mt(e,t){de(e._readable._readableStreamController,t),It(e,t)}function It(e,t){cn(e._transformStreamController),Er(e._writable._writableStreamController,t),e._backpressure&&xt(e,!1)}function xt(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=g(o=>{e._backpressureChangePromise_resolve=o}),e._backpressure=t}class st{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Ut(this))throw Ht("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return kr(t)}enqueue(t=void 0){if(!Ut(this))throw Ht("enqueue");dn(this,t)}error(t=void 0){if(!Ut(this))throw Ht("error");sa(this,t)}terminate(){if(!Ut(this))throw Ht("terminate");la(this)}}Object.defineProperties(st.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof s.toStringTag=="symbol"&&Object.defineProperty(st.prototype,s.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Ut(e){return!h(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof st}function ia(e,t,o,a){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=o,t._flushAlgorithm=a}function aa(e,t){let o=Object.create(st.prototype),a=c=>{try{return dn(o,c),b(void 0)}catch(f){return p(f)}},l=()=>b(void 0);t.transform!==void 0&&(a=c=>t.transform(c,o)),t.flush!==void 0&&(l=()=>t.flush(o)),ia(e,o,a,l)}function cn(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function dn(e,t){let o=e._controlledTransformStream,a=o._readable._readableStreamController;if(!ze(a))throw new TypeError("Readable side is not in a state that permits enqueue");try{Dt(a,t)}catch(l){throw It(o,l),o._readable._storedError}Fi(a)!==o._backpressure&&xt(o,!0)}function sa(e,t){Mt(e._controlledTransformStream,t)}function fn(e,t){let o=e._transformAlgorithm(t);return q(o,void 0,a=>{throw Mt(e._controlledTransformStream,a),a})}function la(e){let t=e._controlledTransformStream,o=t._readable._readableStreamController;it(o);let a=new TypeError("TransformStream terminated");It(t,a)}function ua(e,t){let o=e._transformStreamController;if(e._backpressure){let a=e._backpressureChangePromise;return q(a,()=>{let l=e._writable;if(l._state==="erroring")throw l._storedError;return fn(o,t)})}return fn(o,t)}function ca(e,t){return Mt(e,t),b(void 0)}function da(e){let t=e._readable,o=e._transformStreamController,a=o._flushAlgorithm();return cn(o),q(a,()=>{if(t._state==="errored")throw t._storedError;it(t._readableStreamController)},l=>{throw Mt(e,l),t._storedError})}function fa(e){return xt(e,!1),e._backpressureChangePromise}function Ht(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function hn(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}i.ByteLengthQueuingStrategy=zt,i.CountQueuingStrategy=$t,i.ReadableByteStreamController=Le,i.ReadableStream=fe,i.ReadableStreamBYOBReader=Ze,i.ReadableStreamBYOBRequest=Je,i.ReadableStreamDefaultController=We,i.ReadableStreamDefaultReader=Ye,i.TransformStream=Ft,i.TransformStreamDefaultController=st,i.WritableStream=tt,i.WritableStreamDefaultController=De,i.WritableStreamDefaultWriter=rt,Object.defineProperty(i,"__esModule",{value:!0})})}),Ea=Yr(()=>{if(!globalThis.ReadableStream)try{let r=pa,{emitWarning:n}=r;try{r.emitWarning=()=>{},Object.assign(globalThis,ba),r.emitWarning=n}catch(i){throw r.emitWarning=n,i}}catch{Object.assign(globalThis,Ta())}try{let{Blob:r}=ya;r&&!r.prototype.stream&&(r.prototype.stream=function(n){let i=0,s=this;return new ReadableStream({type:"bytes",async pull(u){let d=await s.slice(i,Math.min(s.size,i+65536)).arrayBuffer();i+=d.byteLength,u.enqueue(new Uint8Array(d)),i===s.size&&u.close()}})})}catch{}});async function*Dr(r,n=!0){for(let i of r)if("stream"in i)yield*i.stream();else if(ArrayBuffer.isView(i))if(n){let s=i.byteOffset,u=i.byteOffset+i.byteLength;for(;s!==u;){let d=Math.min(u-s,xr),y=i.buffer.slice(s,s+d);s+=y.byteLength,yield new Uint8Array(y)}}else yield i;else{let s=0,u=i;for(;s!==u.size;){let d=await u.slice(s,Math.min(u.size,s+xr)).arrayBuffer();s+=d.byteLength,yield new Uint8Array(d)}}}var Pa,xr,Wr,bn,Ve,er=ht(()=>{Pa=Ln(Ea(),1),xr=65536,Wr=class Ur{#e=[];#t="";#r=0;#o="transparent";constructor(n=[],i={}){if(typeof n!="object"||n===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof n[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof i!="object"&&typeof i!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");i===null&&(i={});let s=new TextEncoder;for(let d of n){let y;ArrayBuffer.isView(d)?y=new Uint8Array(d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)):d instanceof ArrayBuffer?y=new Uint8Array(d.slice(0)):d instanceof Ur?y=d:y=s.encode(`${d}`),this.#r+=ArrayBuffer.isView(y)?y.byteLength:y.size,this.#e.push(y)}this.#o=`${i.endings===void 0?"transparent":i.endings}`;let u=i.type===void 0?"":String(i.type);this.#t=/^[\x20-\x7E]*$/.test(u)?u:""}get size(){return this.#r}get type(){return this.#t}async text(){let n=new TextDecoder,i="";for await(let s of Dr(this.#e,!1))i+=n.decode(s,{stream:!0});return i+=n.decode(),i}async arrayBuffer(){let n=new Uint8Array(this.size),i=0;for await(let s of Dr(this.#e,!1))n.set(s,i),i+=s.length;return n.buffer}stream(){let n=Dr(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(i){let s=await n.next();s.done?i.close():i.enqueue(s.value)},async cancel(){await n.return()}})}slice(n=0,i=this.size,s=""){let{size:u}=this,d=n<0?Math.max(u+n,0):Math.min(n,u),y=i<0?Math.max(u+i,0):Math.min(i,u),h=Math.max(y-d,0),v=this.#e,m=[],B=0;for(let j of v){if(B>=h)break;let g=ArrayBuffer.isView(j)?j.byteLength:j.size;if(d&&g<=d)d-=g,y-=g;else{let b;ArrayBuffer.isView(j)?(b=j.subarray(d,Math.min(g,y)),B+=b.byteLength):(b=j.slice(d,Math.min(g,y)),B+=b.size),y-=g,m.push(b),d=0}}let $=new Ur([],{type:String(s).toLowerCase()});return $.#r=h,$.#e=m,$}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](n){return n&&typeof n=="object"&&typeof n.constructor=="function"&&(typeof n.stream=="function"||typeof n.arrayBuffer=="function")&&/^(Blob|File)$/.test(n[Symbol.toStringTag])}},Object.defineProperties(Wr.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),bn=Wr,Ve=bn}),pn,yn,tr,Bn=ht(()=>{er(),pn=class extends Ve{#e=0;#t="";constructor(r,n,i={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(r,i),i===null&&(i={});let s=i.lastModified===void 0?Date.now():Number(i.lastModified);Number.isNaN(s)||(this.#e=s),this.#t=String(n)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](r){return!!r&&r instanceof Ve&&/^(File)$/.test(r[Symbol.toStringTag])}},yn=pn,tr=yn});function Aa(r,n=Ve){var i=`${Hr()}${Hr()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],u=`--${i}\r
Content-Disposition: form-data; name="`;return r.forEach((d,y)=>typeof d=="string"?s.push(u+Qt(y)+`"\r
\r
${d.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(u+Qt(y)+`"; filename="${Qt(d.name,1)}"\r
Content-Type: ${d.type||"application/octet-stream"}\r
\r
`,d,`\r
`)),s.push(`--${i}--`),new n(s,{type:"multipart/form-data; boundary="+i})}var Ie,mn,_n,Hr,gn,zr,Qt,me,dt,Qr=ht(()=>{er(),Bn(),{toStringTag:Ie,iterator:mn,hasInstance:_n}=Symbol,Hr=Math.random,gn="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),zr=(r,n,i)=>(r+="",/^(Blob|File)$/.test(n&&n[Ie])?[(i=i!==void 0?i+"":n[Ie]=="File"?n.name:"blob",r),n.name!==i||n[Ie]=="blob"?new tr([n],i,n):n]:[r,n+""]),Qt=(r,n)=>(n?r:r.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),me=(r,n,i)=>{if(n.length<i)throw new TypeError(`Failed to execute '${r}' on 'FormData': ${i} arguments required, but only ${n.length} present.`)},dt=class{#e=[];constructor(...r){if(r.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[Ie](){return"FormData"}[mn](){return this.entries()}static[_n](r){return r&&typeof r=="object"&&r[Ie]==="FormData"&&!gn.some(n=>typeof r[n]!="function")}append(...r){me("append",arguments,2),this.#e.push(zr(...r))}delete(r){me("delete",arguments,1),r+="",this.#e=this.#e.filter(([n])=>n!==r)}get(r){me("get",arguments,1),r+="";for(var n=this.#e,i=n.length,s=0;s<i;s++)if(n[s][0]===r)return n[s][1];return null}getAll(r,n){return me("getAll",arguments,1),n=[],r+="",this.#e.forEach(i=>i[0]===r&&n.push(i[1])),n}has(r){return me("has",arguments,1),r+="",this.#e.some(n=>n[0]===r)}forEach(r,n){me("forEach",arguments,1);for(var[i,s]of this)r.call(n,s,i,this)}set(...r){me("set",arguments,2);var n=[],i=!0;r=zr(...r),this.#e.forEach(s=>{s[0]===r[0]?i&&(i=!n.push(r)):n.push(s)}),i&&n.push(r),this.#e=n}*entries(){yield*this.#e}*keys(){for(var[r]of this)yield r}*values(){for(var[,r]of this)yield r}}}),Ca=Yr((r,n)=>{if(!globalThis.DOMException)try{let{MessageChannel:i}=ha,s=new i().port1,u=new ArrayBuffer;s.postMessage(u,[u,u])}catch(i){i.constructor.name==="DOMException"&&(globalThis.DOMException=i.constructor)}n.exports=globalThis.DOMException}),Sn,Nt,La,Ba,ja,Da,$r,Fr,Vt,jn=ht(()=>{Sn=Ln(Ca(),1),Bn(),er(),{stat:Nt}=Oa,La=(r,n)=>$r(wn(r),r,n),Ba=(r,n)=>Nt(r).then(i=>$r(i,r,n)),ja=(r,n)=>Nt(r).then(i=>Fr(i,r,n)),Da=(r,n)=>Fr(wn(r),r,n),$r=(r,n,i="")=>new Ve([new Vt({path:n,size:r.size,lastModified:r.mtimeMs,start:0})],{type:i}),Fr=(r,n,i="")=>new tr([new Vt({path:n,size:r.size,lastModified:r.mtimeMs,start:0})],ka(n),{type:i,lastModified:r.mtimeMs}),Vt=class{#e;#t;constructor(r){this.#e=r.path,this.#t=r.start,this.size=r.size,this.lastModified=r.lastModified}slice(r,n){return new Vt({path:this.#e,lastModified:this.lastModified,size:n-r,start:this.#t+r})}async*stream(){let{mtimeMs:r}=await Nt(this.#e);if(r>this.lastModified)throw new Sn.default("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*qa(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}}),Dn={};va(Dn,{toFormData:()=>za});function Wa(r){let n=r.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!n)return;let i=n[2]||n[3]||"",s=i.slice(i.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(u,d)=>String.fromCharCode(d)),s}async function za(r,n){if(!/multipart/i.test(n))throw new TypeError("Failed to fetch");let i=n.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!i)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new Wn(i[1]||i[2]),u,d,y,h,v,m,B=[],$=new dt,j=S=>{y+=E.decode(S,{stream:!0})},g=S=>{B.push(S)},b=()=>{let S=new tr(B,m,{type:v});$.append(h,S)},p=()=>{$.append(h,y)},E=new TextDecoder("utf-8");E.decode(),s.onPartBegin=function(){s.onPartData=j,s.onPartEnd=p,u="",d="",y="",h="",v="",m=null,B.length=0},s.onHeaderField=function(S){u+=E.decode(S,{stream:!0})},s.onHeaderValue=function(S){d+=E.decode(S,{stream:!0})},s.onHeaderEnd=function(){if(d+=E.decode(),u=u.toLowerCase(),u==="content-disposition"){let S=d.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);S&&(h=S[2]||S[3]||""),m=Wa(d),m&&(s.onPartData=g,s.onPartEnd=b)}else u==="content-type"&&(v=d);d="",u=""};for await(let S of r)s.write(S);return s.end(),$}var Z,k,Mr,le,lt,ut,vn,xe,Rn,Tn,En,Pn,_e,Wn,$a=ht(()=>{jn(),Qr(),Z=0,k={START_BOUNDARY:Z++,HEADER_FIELD_START:Z++,HEADER_FIELD:Z++,HEADER_VALUE_START:Z++,HEADER_VALUE:Z++,HEADER_VALUE_ALMOST_DONE:Z++,HEADERS_ALMOST_DONE:Z++,PART_DATA_START:Z++,PART_DATA:Z++,END:Z++},Mr=1,le={PART_BOUNDARY:Mr,LAST_BOUNDARY:Mr*=2},lt=10,ut=13,vn=32,xe=45,Rn=58,Tn=97,En=122,Pn=r=>r|32,_e=()=>{},Wn=class{constructor(r){this.index=0,this.flags=0,this.onHeaderEnd=_e,this.onHeaderField=_e,this.onHeadersEnd=_e,this.onHeaderValue=_e,this.onPartBegin=_e,this.onPartData=_e,this.onPartEnd=_e,this.boundaryChars={},r=`\r
--`+r;let n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i),this.boundaryChars[n[i]]=!0;this.boundary=n,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=k.START_BOUNDARY}write(r){let n=0,i=r.length,s=this.index,{lookbehind:u,boundary:d,boundaryChars:y,index:h,state:v,flags:m}=this,B=this.boundary.length,$=B-1,j=r.length,g,b,p=M=>{this[M+"Mark"]=n},E=M=>{delete this[M+"Mark"]},S=(M,q,L,D)=>{(q===void 0||q!==L)&&this[M](D&&D.subarray(q,L))},F=(M,q)=>{let L=M+"Mark";L in this&&(q?(S(M,this[L],n,r),delete this[L]):(S(M,this[L],r.length,r),this[L]=0))};for(n=0;n<i;n++)switch(g=r[n],v){case k.START_BOUNDARY:if(h===d.length-2){if(g===xe)m|=le.LAST_BOUNDARY;else if(g!==ut)return;h++;break}else if(h-1===d.length-2){if(m&le.LAST_BOUNDARY&&g===xe)v=k.END,m=0;else if(!(m&le.LAST_BOUNDARY)&&g===lt)h=0,S("onPartBegin"),v=k.HEADER_FIELD_START;else return;break}g!==d[h+2]&&(h=-2),g===d[h+2]&&h++;break;case k.HEADER_FIELD_START:v=k.HEADER_FIELD,p("onHeaderField"),h=0;case k.HEADER_FIELD:if(g===ut){E("onHeaderField"),v=k.HEADERS_ALMOST_DONE;break}if(h++,g===xe)break;if(g===Rn){if(h===1)return;F("onHeaderField",!0),v=k.HEADER_VALUE_START;break}if(b=Pn(g),b<Tn||b>En)return;break;case k.HEADER_VALUE_START:if(g===vn)break;p("onHeaderValue"),v=k.HEADER_VALUE;case k.HEADER_VALUE:g===ut&&(F("onHeaderValue",!0),S("onHeaderEnd"),v=k.HEADER_VALUE_ALMOST_DONE);break;case k.HEADER_VALUE_ALMOST_DONE:if(g!==lt)return;v=k.HEADER_FIELD_START;break;case k.HEADERS_ALMOST_DONE:if(g!==lt)return;S("onHeadersEnd"),v=k.PART_DATA_START;break;case k.PART_DATA_START:v=k.PART_DATA,p("onPartData");case k.PART_DATA:if(s=h,h===0){for(n+=$;n<j&&!(r[n]in y);)n+=B;n-=$,g=r[n]}if(h<d.length)d[h]===g?(h===0&&F("onPartData",!0),h++):h=0;else if(h===d.length)h++,g===ut?m|=le.PART_BOUNDARY:g===xe?m|=le.LAST_BOUNDARY:h=0;else if(h-1===d.length)if(m&le.PART_BOUNDARY){if(h=0,g===lt){m&=~le.PART_BOUNDARY,S("onPartEnd"),S("onPartBegin"),v=k.HEADER_FIELD_START;break}}else m&le.LAST_BOUNDARY&&g===xe?(S("onPartEnd"),v=k.END,m=0):h=0;if(h>0)u[h-1]=g;else if(s>0){let M=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);S("onPartData",0,s,M),s=0,p("onPartData"),n--}break;case k.END:break;default:throw new Error(`Unexpected state entered: ${v}`)}F("onHeaderField"),F("onHeaderValue"),F("onPartData"),this.index=h,this.state=v,this.flags=m}end(){if(this.state===k.HEADER_FIELD_START&&this.index===0||this.state===k.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==k.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});function Ia(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let n=r.indexOf(",");if(n===-1||n<=4)throw new TypeError("malformed data: URI");let i=r.substring(5,n).split(";"),s="",u=!1,d=i[0]||"text/plain",y=d;for(let B=1;B<i.length;B++)i[B]==="base64"?u=!0:i[B]&&(y+=`;${i[B]}`,i[B].indexOf("charset=")===0&&(s=i[B].substring(8)));!i[0]&&!s.length&&(y+=";charset=US-ASCII",s="US-ASCII");let h=u?"base64":"ascii",v=unescape(r.substring(n+1)),m=Buffer.from(v,h);return m.type=d,m.typeFull=y,m.charset=s,m}var xa=Ia;er();Qr();var rr=class extends Error{constructor(r,n){super(r),Error.captureStackTrace(this,this.constructor),this.type=n}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}},re=class extends rr{constructor(r,n,i){super(r,n),i&&(this.code=this.errno=i.code,this.erroredSysCall=i.syscall)}},Jt=Symbol.toStringTag,$n=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[Jt]==="URLSearchParams",Kt=r=>r&&typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[Jt]),Ha=r=>typeof r=="object"&&(r[Jt]==="AbortSignal"||r[Jt]==="EventTarget"),Na=(r,n)=>{let i=new URL(n).hostname,s=new URL(r).hostname;return i===s||i.endsWith(`.${s}`)},Va=(r,n)=>{let i=new URL(n).protocol,s=new URL(r).protocol;return i===s},Ya=Ua(ge.pipeline),U=Symbol("Body internals"),ft=class{constructor(r,{size:n=0}={}){let i=null;r===null?r=null:$n(r)?r=Y.from(r.toString()):Kt(r)||Y.isBuffer(r)||(zn.isAnyArrayBuffer(r)?r=Y.from(r):ArrayBuffer.isView(r)?r=Y.from(r.buffer,r.byteOffset,r.byteLength):r instanceof ge||(r instanceof dt?(r=Aa(r),i=r.type.split("=")[1]):r=Y.from(String(r))));let s=r;Y.isBuffer(r)?s=ge.Readable.from(r):Kt(r)&&(s=ge.Readable.from(r.stream())),this[U]={body:r,stream:s,boundary:i,disturbed:!1,error:null},this.size=n,r instanceof ge&&r.on("error",u=>{let d=u instanceof rr?u:new re(`Invalid response body while trying to fetch ${this.url}: ${u.message}`,"system",u);this[U].error=d})}get body(){return this[U].stream}get bodyUsed(){return this[U].disturbed}async arrayBuffer(){let{buffer:r,byteOffset:n,byteLength:i}=await Ir(this);return r.slice(n,n+i)}async formData(){let r=this.headers.get("content-type");if(r.startsWith("application/x-www-form-urlencoded")){let i=new dt,s=new URLSearchParams(await this.text());for(let[u,d]of s)i.append(u,d);return i}let{toFormData:n}=await Promise.resolve().then(()=>($a(),Dn));return n(this.body,r)}async blob(){let r=this.headers&&this.headers.get("content-type")||this[U].body&&this[U].body.type||"",n=await this.arrayBuffer();return new Ve([n],{type:r})}async json(){let r=await this.text();return JSON.parse(r)}async text(){let r=await Ir(this);return new TextDecoder().decode(r)}buffer(){return Ir(this)}};ft.prototype.buffer=Gr(ft.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(ft.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:Gr(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function Ir(r){if(r[U].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[U].disturbed=!0,r[U].error)throw r[U].error;let{body:n}=r;if(n===null)return Y.alloc(0);if(!(n instanceof ge))return Y.alloc(0);let i=[],s=0;try{for await(let u of n){if(r.size>0&&s+u.length>r.size){let d=new re(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw n.destroy(d),d}s+=u.length,i.push(u)}}catch(u){throw u instanceof rr?u:new re(`Invalid response body while trying to fetch ${r.url}: ${u.message}`,"system",u)}if(n.readableEnded===!0||n._readableState.ended===!0)try{return i.every(u=>typeof u=="string")?Y.from(i.join("")):Y.concat(i,s)}catch(u){throw new re(`Could not create Buffer from response body for ${r.url}: ${u.message}`,"system",u)}else throw new re(`Premature close of server response while trying to fetch ${r.url}`)}var Jr=(r,n)=>{let i,s,{body:u}=r[U];if(r.bodyUsed)throw new Error("cannot clone body after it is used");return u instanceof ge&&typeof u.getBoundary!="function"&&(i=new qn({highWaterMark:n}),s=new qn({highWaterMark:n}),u.pipe(i),u.pipe(s),r[U].stream=i,u=s),u},Qa=Gr(r=>r.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Fn=(r,n)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":$n(r)?"application/x-www-form-urlencoded;charset=UTF-8":Kt(r)?r.type||null:Y.isBuffer(r)||zn.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r instanceof dt?`multipart/form-data; boundary=${n[U].boundary}`:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${Qa(r)}`:r instanceof ge?null:"text/plain;charset=UTF-8",Ga=r=>{let{body:n}=r[U];return n===null?0:Kt(n)?n.size:Y.isBuffer(n)?n.length:n&&typeof n.getLengthSync=="function"&&n.hasKnownLength&&n.hasKnownLength()?n.getLengthSync():null},Ja=async(r,{body:n})=>{n===null?r.end():await Ya(n,r)},Gt=typeof Xt.validateHeaderName=="function"?Xt.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let n=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),n}},Nr=typeof Xt.validateHeaderValue=="function"?Xt.validateHeaderValue:(r,n)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(n)){let i=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(i,"code",{value:"ERR_INVALID_CHAR"}),i}},we=class extends URLSearchParams{constructor(r){let n=[];if(r instanceof we){let i=r.raw();for(let[s,u]of Object.entries(i))n.push(...u.map(d=>[s,d]))}else if(r!=null)if(typeof r=="object"&&!On.isBoxedPrimitive(r)){let i=r[Symbol.iterator];if(i==null)n.push(...Object.entries(r));else{if(typeof i!="function")throw new TypeError("Header pairs must be iterable");n=[...r].map(s=>{if(typeof s!="object"||On.isBoxedPrimitive(s))throw new TypeError("Each header pair must be an iterable object");return[...s]}).map(s=>{if(s.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...s]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return n=n.length>0?n.map(([i,s])=>(Gt(i),Nr(i,String(s)),[String(i).toLowerCase(),String(s)])):void 0,super(n),new Proxy(this,{get(i,s,u){switch(s){case"append":case"set":return(d,y)=>(Gt(d),Nr(d,String(y)),URLSearchParams.prototype[s].call(i,String(d).toLowerCase(),String(y)));case"delete":case"has":case"getAll":return d=>(Gt(d),URLSearchParams.prototype[s].call(i,String(d).toLowerCase()));case"keys":return()=>(i.sort(),new Set(URLSearchParams.prototype.keys.call(i)).keys());default:return Reflect.get(i,s,u)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(r){let n=this.getAll(r);if(n.length===0)return null;let i=n.join(", ");return/^content-encoding$/i.test(r)&&(i=i.toLowerCase()),i}forEach(r,n=void 0){for(let i of this.keys())Reflect.apply(r,n,[this.get(i),i,this])}*values(){for(let r of this.keys())yield this.get(r)}*entries(){for(let r of this.keys())yield[r,this.get(r)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((r,n)=>(r[n]=this.getAll(n),r),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((r,n)=>{let i=this.getAll(n);return n==="host"?r[n]=i[0]:r[n]=i.length>1?i:i[0],r},{})}};Object.defineProperties(we.prototype,["get","entries","forEach","values"].reduce((r,n)=>(r[n]={enumerable:!0},r),{}));function Ka(r=[]){return new we(r.reduce((n,i,s,u)=>(s%2===0&&n.push(u.slice(s,s+2)),n),[]).filter(([n,i])=>{try{return Gt(n),Nr(n,String(i)),!0}catch{return!1}}))}var Xa=new Set([301,302,303,307,308]),Mn=r=>Xa.has(r),ee=Symbol("Response internals"),V=class extends ft{constructor(r=null,n={}){super(r,n);let i=n.status!=null?n.status:200,s=new we(n.headers);if(r!==null&&!s.has("Content-Type")){let u=Fn(r,this);u&&s.append("Content-Type",u)}this[ee]={type:"default",url:n.url,status:i,statusText:n.statusText||"",headers:s,counter:n.counter,highWaterMark:n.highWaterMark}}get type(){return this[ee].type}get url(){return this[ee].url||""}get status(){return this[ee].status}get ok(){return this[ee].status>=200&&this[ee].status<300}get redirected(){return this[ee].counter>0}get statusText(){return this[ee].statusText}get headers(){return this[ee].headers}get highWaterMark(){return this[ee].highWaterMark}clone(){return new V(Jr(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(r,n=302){if(!Mn(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new V(null,{headers:{location:new URL(r).toString()},status:n})}static error(){let r=new V(null,{status:0,statusText:""});return r[ee].type="error",r}static json(r=void 0,n={}){let i=JSON.stringify(r);if(i===void 0)throw new TypeError("data is not JSON serializable");let s=new we(n&&n.headers);return s.has("content-type")||s.set("content-type","application/json"),new V(i,{...n,headers:s})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(V.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var ts=r=>{if(r.search)return r.search;let n=r.href.length-1,i=r.hash||(r.href[n]==="#"?"#":"");return r.href[n-i.length]==="?"?"?":""};function kn(r,n=!1){return r==null||(r=new URL(r),/^(about|blob|data):$/.test(r.protocol))?"no-referrer":(r.username="",r.password="",r.hash="",n&&(r.pathname="",r.search=""),r)}var In=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),os="strict-origin-when-cross-origin";function ns(r){if(!In.has(r))throw new TypeError(`Invalid referrerPolicy: ${r}`);return r}function is(r){if(/^(http|ws)s:$/.test(r.protocol))return!0;let n=r.host.replace(/(^\[)|(]$)/g,""),i=rs(n);return i===4&&/^127\./.test(n)||i===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(n)?!0:r.host==="localhost"||r.host.endsWith(".localhost")?!1:r.protocol==="file:"}function Ne(r){return/^about:(blank|srcdoc)$/.test(r)||r.protocol==="data:"||/^(blob|filesystem):$/.test(r.protocol)?!0:is(r)}function as(r,{referrerURLCallback:n,referrerOriginCallback:i}={}){if(r.referrer==="no-referrer"||r.referrerPolicy==="")return null;let s=r.referrerPolicy;if(r.referrer==="about:client")return"no-referrer";let u=r.referrer,d=kn(u),y=kn(u,!0);d.toString().length>4096&&(d=y),n&&(d=n(d)),i&&(y=i(y));let h=new URL(r.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return y;case"unsafe-url":return d;case"strict-origin":return Ne(d)&&!Ne(h)?"no-referrer":y.toString();case"strict-origin-when-cross-origin":return d.origin===h.origin?d:Ne(d)&&!Ne(h)?"no-referrer":y;case"same-origin":return d.origin===h.origin?d:"no-referrer";case"origin-when-cross-origin":return d.origin===h.origin?d:y;case"no-referrer-when-downgrade":return Ne(d)&&!Ne(h)?"no-referrer":d;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function ss(r){let n=(r.get("referrer-policy")||"").split(/[,\s]+/),i="";for(let s of n)s&&In.has(s)&&(i=s);return i}var z=Symbol("Request internals"),ct=r=>typeof r=="object"&&typeof r[z]=="object",ls=es(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),Zt=class extends ft{constructor(r,n={}){let i;if(ct(r)?i=new URL(r.url):(i=new URL(r),r={}),i.username!==""||i.password!=="")throw new TypeError(`${i} is an url with embedded credentials.`);let s=n.method||r.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(s)&&(s=s.toUpperCase()),!ct(n)&&"data"in n&&ls(),(n.body!=null||ct(r)&&r.body!==null)&&(s==="GET"||s==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let u=n.body?n.body:ct(r)&&r.body!==null?Jr(r):null;super(u,{size:n.size||r.size||0});let d=new we(n.headers||r.headers||{});if(u!==null&&!d.has("Content-Type")){let v=Fn(u,this);v&&d.set("Content-Type",v)}let y=ct(r)?r.signal:null;if("signal"in n&&(y=n.signal),y!=null&&!Ha(y))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let h=n.referrer==null?r.referrer:n.referrer;if(h==="")h="no-referrer";else if(h){let v=new URL(h);h=/^about:(\/\/)?client$/.test(v)?"client":v}else h=void 0;this[z]={method:s,redirect:n.redirect||r.redirect||"follow",headers:d,parsedURL:i,signal:y,referrer:h},this.follow=n.follow===void 0?r.follow===void 0?20:r.follow:n.follow,this.compress=n.compress===void 0?r.compress===void 0?!0:r.compress:n.compress,this.counter=n.counter||r.counter||0,this.agent=n.agent||r.agent,this.highWaterMark=n.highWaterMark||r.highWaterMark||16384,this.insecureHTTPParser=n.insecureHTTPParser||r.insecureHTTPParser||!1,this.referrerPolicy=n.referrerPolicy||r.referrerPolicy||""}get method(){return this[z].method}get url(){return Za(this[z].parsedURL)}get headers(){return this[z].headers}get redirect(){return this[z].redirect}get signal(){return this[z].signal}get referrer(){if(this[z].referrer==="no-referrer")return"";if(this[z].referrer==="client")return"about:client";if(this[z].referrer)return this[z].referrer.toString()}get referrerPolicy(){return this[z].referrerPolicy}set referrerPolicy(r){this[z].referrerPolicy=ns(r)}clone(){return new Zt(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Zt.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var us=r=>{let{parsedURL:n}=r[z],i=new we(r[z].headers);i.has("Accept")||i.set("Accept","*/*");let s=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(s="0"),r.body!==null){let h=Ga(r);typeof h=="number"&&!Number.isNaN(h)&&(s=String(h))}s&&i.set("Content-Length",s),r.referrerPolicy===""&&(r.referrerPolicy=os),r.referrer&&r.referrer!=="no-referrer"?r[z].referrer=as(r):r[z].referrer="no-referrer",r[z].referrer instanceof URL&&i.set("Referer",r.referrer),i.has("User-Agent")||i.set("User-Agent","node-fetch"),r.compress&&!i.has("Accept-Encoding")&&i.set("Accept-Encoding","gzip, deflate, br");let{agent:u}=r;typeof u=="function"&&(u=u(n)),!i.has("Connection")&&!u&&i.set("Connection","close");let d=ts(n),y={path:n.pathname+d,method:r.method,headers:i[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:u};return{parsedURL:n,options:y}},cs=class extends rr{constructor(r,n="aborted"){super(r,n)}};Qr();jn();var ds=new Set(["data:","http:","https:"]);async function fs(r,n){return new Promise((i,s)=>{let u=new Zt(r,n),{parsedURL:d,options:y}=us(u);if(!ds.has(d.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${d.protocol.replace(/:$/,"")}" is not supported.`);if(d.protocol==="data:"){let b=xa(u.url),p=new V(b,{headers:{"Content-Type":b.typeFull}});i(p);return}let h=(d.protocol==="https:"?Ma:Fa).request,{signal:v}=u,m=null,B=()=>{let b=new cs("The operation was aborted.");s(b),u.body&&u.body instanceof An.Readable&&u.body.destroy(b),!(!m||!m.body)&&m.body.emit("error",b)};if(v&&v.aborted){B();return}let $=()=>{B(),g()},j=h(d.toString(),y);v&&v.addEventListener("abort",$);let g=()=>{j.abort(),v&&v.removeEventListener("abort",$)};j.on("error",b=>{s(new re(`request to ${u.url} failed, reason: ${b.message}`,"system",b)),g()}),hs(j,b=>{m&&m.body&&m.body.destroy(b)}),process.version<"v14"&&j.on("socket",b=>{let p;b.prependListener("end",()=>{p=b._eventsCount}),b.prependListener("close",E=>{if(m&&p<b._eventsCount&&!E){let S=new Error("Premature close");S.code="ERR_STREAM_PREMATURE_CLOSE",m.body.emit("error",S)}})}),j.on("response",b=>{j.setTimeout(0);let p=Ka(b.rawHeaders);if(Mn(b.statusCode)){let q=p.get("Location"),L=null;try{L=q===null?null:new URL(q,u.url)}catch{if(u.redirect!=="manual"){s(new re(`uri requested responds with an invalid redirect URL: ${q}`,"invalid-redirect")),g();return}}switch(u.redirect){case"error":s(new re(`uri requested responds with a redirect, redirect mode is set to error: ${u.url}`,"no-redirect")),g();return;case"manual":break;case"follow":{if(L===null)break;if(u.counter>=u.follow){s(new re(`maximum redirect reached at: ${u.url}`,"max-redirect")),g();return}let D={headers:new we(u.headers),follow:u.follow,counter:u.counter+1,agent:u.agent,compress:u.compress,method:u.method,body:Jr(u),signal:u.signal,size:u.size,referrer:u.referrer,referrerPolicy:u.referrerPolicy};if(!Na(u.url,L)||!Va(u.url,L))for(let oe of["authorization","www-authenticate","cookie","cookie2"])D.headers.delete(oe);if(b.statusCode!==303&&u.body&&n.body instanceof An.Readable){s(new re("Cannot follow redirect with body being a readable stream","unsupported-redirect")),g();return}(b.statusCode===303||(b.statusCode===301||b.statusCode===302)&&u.method==="POST")&&(D.method="GET",D.body=void 0,D.headers.delete("content-length"));let Se=ss(p);Se&&(D.referrerPolicy=Se),i(fs(new Zt(L,D))),g();return}default:return s(new TypeError(`Redirect option '${u.redirect}' is not a valid value of RequestRedirect`))}}v&&b.once("end",()=>{v.removeEventListener("abort",$)});let E=He(b,new Cn,q=>{q&&s(q)});process.version<"v12.10"&&b.on("aborted",$);let S={url:u.url,status:b.statusCode,statusText:b.statusMessage,headers:p,size:u.size,counter:u.counter,highWaterMark:u.highWaterMark},F=p.get("Content-Encoding");if(!u.compress||u.method==="HEAD"||F===null||b.statusCode===204||b.statusCode===304){m=new V(E,S),i(m);return}let M={flush:Ue.Z_SYNC_FLUSH,finishFlush:Ue.Z_SYNC_FLUSH};if(F==="gzip"||F==="x-gzip"){E=He(E,Ue.createGunzip(M),q=>{q&&s(q)}),m=new V(E,S),i(m);return}if(F==="deflate"||F==="x-deflate"){let q=He(b,new Cn,L=>{L&&s(L)});q.once("data",L=>{(L[0]&15)===8?E=He(E,Ue.createInflate(),D=>{D&&s(D)}):E=He(E,Ue.createInflateRaw(),D=>{D&&s(D)}),m=new V(E,S),i(m)}),q.once("end",()=>{m||(m=new V(E,S),i(m))});return}if(F==="br"){E=He(E,Ue.createBrotliDecompress(),q=>{q&&s(q)}),m=new V(E,S),i(m);return}m=new V(E,S),i(m)}),Ja(j,u).catch(s)})}function hs(r,n){let i=Yt.from(`0\r
\r
`),s=!1,u=!1,d;r.on("response",y=>{let{headers:h}=y;s=h["transfer-encoding"]==="chunked"&&!h["content-length"]}),r.on("socket",y=>{let h=()=>{if(s&&!u){let m=new Error("Premature close");m.code="ERR_STREAM_PREMATURE_CLOSE",n(m)}},v=m=>{u=Yt.compare(m.slice(-5),i)===0,!u&&d&&(u=Yt.compare(d.slice(-3),i.slice(0,3))===0&&Yt.compare(m.slice(-2),i.slice(3))===0),d=m};y.prependListener("close",h),y.on("data",v),r.on("close",()=>{y.removeListener("close",h),y.removeListener("data",v)})})}export{cs as AbortError,Ve as Blob,re as FetchError,tr as File,dt as FormData,we as Headers,Zt as Request,V as Response,Ba as blobFrom,La as blobFromSync,fs as default,ja as fileFrom,Da as fileFromSync,Mn as isRedirect};
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)
*/
//# sourceMappingURL=node-fetch.bundle.js.map